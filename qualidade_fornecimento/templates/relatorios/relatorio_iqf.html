{% extends 'base.html' %}
{% load static %}

{% block content %}
{% include 'partials/global/_estilos_impressao.html' %}
{% include 'partials/global/_styles_componentes.html' %}
{% include 'partials/global/_botao_impressao.html' %}

<div class="container pdf-container">

  <!-- Cabe√ßalho -->
  <div class="header mb-4">
    <table class="info-table">
      <tr>
        <td style="width: 20%; text-align: center;">
          <img src="/static/logo.png" alt="Logo Bras-Mol" style="max-width: 60px;">
        </td>
        <td style="width: 60%; text-align: center;">
          <strong>üìä Indicador:</strong><br>8.1 - IQF - √çndice de Qualidade de Fornecimento
        </td>
        <td style="width: 20%; text-align: center;">
          <strong>Respons√°vel:</strong><br>Gilberto Fernandes
        </td>
      </tr>
      <tr>
        <td colspan="2">
          <strong>üéØ Objetivo:</strong> Monitorar o desempenho dos fornecedores.
        </td>
        <td class="text-center">
          <strong>üéØ Meta:</strong><br> ‚â• 90%
        </td>
      </tr>
    </table>
  </div>

  <!-- Gr√°fico e M√©dia -->
  <div class="grafico-midia-container mb-4 mt-4 d-flex flex-column flex-md-row justify-content-between align-items-start gap-4">
    <div class="grafico-box" style="flex: 0 0 65%;">
      {% if grafico_base64 %}
        <img src="data:image/png;base64,{{ grafico_base64 }}" alt="Gr√°fico IQF"
             class="img-fluid border rounded shadow-sm d-block mx-auto"
             style="max-height: 260px; max-width: 100%;">
      {% else %}
        {% include 'partials/global/_sem_resultados.html' with item_nome="gr√°fico" %}
      {% endif %}
    </div>

    <div class="media-box" style="flex: 0 0 33%;">
      <div class="media-card p-3 bg-light rounded shadow-sm border h-100">
        <table class="table table-bordered text-center mb-0">
          <thead class="table-light">
            <tr>
              <th colspan="2"><i class="bi bi-bar-chart-line me-1"></i> M√©dia Geral</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><i class="bi bi-graph-up me-1"></i> IQF</td>
              <td style="{% if media >= 90 %}color: green;{% else %}color: red;{% endif %}">
                <strong>{{ media }}%</strong>
                <span class="fs-5">
                  {% if media >= 90 %} ‚úÖ {% else %} ‚ö†Ô∏è {% endif %}
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Tabela por M√™s -->
  <div class="indicadores-container mt-4">
    <table class="table table-bordered table-striped text-center align-middle custom-table">
      <thead class="table-light">
        <tr>
          <th><i class="bi bi-calendar me-1"></i> M√™s</th>
          <th><i class="bi bi-bar-chart-fill me-1"></i> √çndice</th>
          <th><i class="bi bi-bullseye me-1"></i> Meta</th>
          <th><i class="bi bi-chat-left-text me-1"></i> Status</th>
        </tr>
      </thead>
      <tbody>
        {% for mes, valor in dados.items %}
        <tr>
          <td>{{ mes }}</td>
          <td><strong>{{ valor }}%</strong></td>
          <td>90%</td>
          <td>
            {% if valor >= 90 %}
              <span class="text-success">Dentro da Meta</span>
            {% else %}
              <span class="text-danger">Fora da Meta</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- An√°lise -->
  <div class="analise-dados mt-5">
    <h5 class="text-center mb-3 text-primary"><i class="bi bi-bar-chart-steps me-1"></i> An√°lise dos Dados</h5>
    <ul>
      {% for comentario in comentarios %}
      <li>{{ comentario }}</li>
      {% endfor %}
    </ul>
  </div>

  <!-- Plano de A√ß√£o -->
  <div class="plano-acao mt-5">
    <h5 class="text-center mb-3 text-warning"><i class="bi bi-tools me-1"></i> Plano de A√ß√£o</h5>
    <p class="text-muted text-center">Sem a√ß√µes corretivas no per√≠odo.</p>
  </div>

  <!-- Rodap√© institucional -->
  {% include 'partials/global/_formulario_rodape.html' with numero_formulario="" %}
</div>
{% endblock %}

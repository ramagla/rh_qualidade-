{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}
{% load tz %}

{% block title %}Visualiza√ß√£o da Integra√ß√£o{% endblock %}

{% block content %}
  {% include "partials/global/_estilos_impressao.html" %}
  {% include "partials/global/_botao_impressao.html" %}
{% include 'header.html' %}

  <div id="relatorio-area">
    <div class="pdf-container">
      <!-- Cabe√ßalho -->
      <div class="pdf-header text-center">
        <h1>üìã Integra√ß√£o</h1>
        <p>Visualiza√ß√£o detalhada da integra√ß√£o do colaborador</p>
      </div>

      <!-- Conte√∫do -->
      <div class="pdf-content">
        <div class="table-responsive">
          <table class="table table-bordered info-table">
            <!-- Informa√ß√µes da Integra√ß√£o -->
            <tr>
              <th class="align-middle">Colaborador</th>
              <td class="align-middle">{{ integracao.funcionario.nome }}</td>
            </tr>
            <tr>
              <th class="align-middle">Data de Integra√ß√£o</th>
              <td class="align-middle">{{ integracao.data_integracao|date:"d/m/Y" }}</td>
            </tr>
            <tr>
              <th class="align-middle">Grupo WhatsApp</th>
              <td class="align-middle">{{ integracao.grupo_whatsapp|yesno:"Sim,N√£o" }}</td>
            </tr>
            <tr>
              <th class="align-middle">Requer Treinamento</th>
              <td class="align-middle">{{ integracao.requer_treinamento|yesno:"Sim,N√£o" }}</td>
            </tr>

            <!-- PDF da Integra√ß√£o -->
            <tr>
              <th class="align-middle">PDF da Integra√ß√£o Assinada</th>
              <td class="align-middle">
                {% if integracao.pdf_integracao %}
                  <a href="{{ integracao.pdf_integracao.url }}" class="btn btn-info btn-sm" download>
                    <i class="bi bi-download"></i> Baixar
                  </a>
                  <span class="small text-muted">({{ integracao.pdf_integracao.name|basename }})</span>
                {% else %}
                  N√£o dispon√≠vel
                {% endif %}
              </td>
            </tr>

            <!-- Foto do Colaborador -->
            <tr>
              <th class="align-middle">Foto do Colaborador</th>
              <td class="align-middle text-center">
                {% if integracao.funcionario.foto %}
                  <img src="{{ integracao.funcionario.foto.url }}"
                       alt="Foto do Colaborador"
                       style="width:100px; height:100px; object-fit:cover; border-radius:50%;">
                {% else %}
                  Sem foto cadastrada
                {% endif %}
              </td>
            </tr>
          </table>
        </div>
      </div>

      <!-- Rodap√© -->
      <div class="pdf-footer text-center text-muted small">
        <p class="mb-1">
          <i class="bi bi-clock me-1" aria-hidden="true"></i>
          Relat√≥rio gerado em {{ now|date:"d/m/Y H:i" }}
        </p>
        <p class="mb-0 fst-italic">
          {% include "partials/global/_rodape_institucional.html" %}
        </p>
      </div>
    </div>

    <!-- Bot√£o Voltar -->
    <div class="text-center mt-4 d-print-none">
      <a href="{% url 'lista_integracoes' %}" class="btn btn-secondary">
        <i class="bi bi-arrow-left-circle"></i> Voltar
      </a>
    </div>
  </div>
{% endblock %}

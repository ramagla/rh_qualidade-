{% extends 'base.html' %}
{% load custom_filters %}

{% block title %}Avalia√ß√µes de Job Rotation{% endblock %}

{% block content %}
<div class="container mt-5">

  {% include "partials/global/_header_titulo.html" with titulo="Avalia√ß√µes de Job Rotation" icone="bi bi-clipboard-check" emoji="üìù" %}
  {% include "partials/global/_toast_mensagens.html" %}

  <!-- Bot√µes -->
  <div class="d-flex justify-content-end flex-wrap gap-2 mb-3">
    {% if request.user|has_permission:'Funcionario.add_jobrotationevaluation' %}
      <a href="{% url 'cadastrar_jobrotation_evaluation' %}" class="btn btn-primary">
        <i class="bi bi-plus-circle me-1"></i> Nova Avalia√ß√£o
      </a>
    {% endif %}
  </div>

  <!-- Lista -->
  <div class="table-responsive">
    <table class="table table-striped table-bordered align-middle text-center">
      <thead class="table-light">
        <tr>
          <th>Colaborador</th>
          <th>Cargo Atual</th>
          <th>Nova Fun√ß√£o</th>
          <th>Data In√≠cio</th>
          <th>Status RH</th>
          <th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody>
        {% for evaluation in evaluations %}
        <tr>
          <td>{{ evaluation.funcionario.nome }}</td>
          <td>{{ evaluation.cargo_atual.nome|default:"‚Äî" }}</td>
          <td>{{ evaluation.nova_funcao.nome|default:"‚Äî" }}</td>
          <td>{{ evaluation.data_inicio|date:"d/m/Y" }}</td>
          <td>
            {% if evaluation.avaliacao_rh == 'Apto' %}
              <span class="badge bg-success">Apto</span>
            {% elif evaluation.avaliacao_rh == 'Inapto' %}
              <span class="badge bg-danger">Inapto</span>
            {% elif evaluation.avaliacao_rh == 'Prorrogar TN' %}
              <span class="badge bg-warning text-dark">Prorrogar TN</span>
            {% else %}
              <span class="badge bg-secondary">Em progresso</span>
            {% endif %}
          </td>
          <td>
            {% include "partials/global/_botao_visualizar.html" with objeto=evaluation url_visualizar='visualizar_jobrotation_evaluation' label='avalia√ß√£o' %}
            {% include "partials/global/_botao_editar.html" with objeto=evaluation url_editar='editar_jobrotation_evaluation' label='avalia√ß√£o' %}
            {% include "partials/global/_botao_excluir.html" with objeto=evaluation url_excluir='excluir_jobrotation' label='avalia√ß√£o' %}
          </td>
        </tr>
        {% empty %}
          {% include "partials/global/_sem_resultados.html" with item_nome="avalia√ß√£o" %}
        {% endfor %}
      </tbody>
    </table>
  </div>

  {% include "partials/global/_paginacao.html" %}
</div>
{% endblock %}

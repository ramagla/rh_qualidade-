{% load widget_tweaks %}

<div class="col-md-12">
  <div class="border rounded p-3 bg-light">
    <label class="form-label fw-semibold d-flex align-items-center gap-2 mb-2" for="id_anexo">
      <i class="bi bi-paperclip text-primary"></i>
      Anexo do Documento (opcional)
    </label>

    {% if form.instance.anexo %}
      <div class="d-flex justify-content-between align-items-center bg-white border rounded px-3 py-2 mb-3">
        <div class="d-flex align-items-center gap-2">
          <i class="bi bi-file-earmark-text text-muted"></i>
          <a href="{{ form.instance.anexo.url }}" target="_blank" class="link-primary text-truncate" style="max-width: 300px;">
            {{ form.instance.anexo.name|cut:"avaliacoes/anual/"|cut:"avaliacoes/experiencia/" }}
          </a>
        </div>
        <button type="button" class="btn btn-outline-danger btn-sm" onclick="removerAnexo()">
          <i class="bi bi-trash"></i> Excluir
        </button>
      </div>
      <input type="hidden" name="remover_anexo" id="remover_anexo" value="0">
    {% endif %}

    <input type="file" name="{{ form.anexo.html_name }}" id="id_anexo" class="form-control">
    <small class="text-muted d-block mt-1">Nenhum arquivo selecionado.</small>
  </div>
</div>

<script>
  function removerAnexo() {
    if (confirm("Tem certeza que deseja excluir o anexo atual?")) {
      document.getElementById("remover_anexo").value = "1";
      document.getElementById("form-avaliacao").submit();
    }
  }
</script>

{% extends 'base.html' %}
{% load widget_tweaks %}

{% block title %}Cadastrar Equipamento{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4">Cadastrar Equipamento</h2>

    <!-- Mensagens de erro -->
    {% if form.errors %}
        <div class="alert alert-danger">
            <strong>Erro ao salvar o formulário:</strong>
            <ul>
                {% for field, errors in form.errors.items %}
                    <li><strong>{{ field }}:</strong> {{ errors|join:", " }}</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    <form method="post" enctype="multipart/form-data" class="row g-3">
        {% csrf_token %}

        <!-- Foto do equipamento -->
        <div class="col-md-6 text-center">
            <label for="foto_equipamento" class="form-label">Foto do Equipamento:</label>
            {% if equipamento.foto_equipamento %}
                <div class="mt-2">
                    <img src="{{ equipamento.foto_equipamento.url }}" alt="{{ equipamento.codigo }}" style="width: 150px; height: 150px; object-fit: cover;">
                </div>
            {% endif %}
            <div class="mt-3">
                <input type="file" id="id_foto_equipamento" name="foto_equipamento" class="form-control">
            </div>
        </div>

        <!-- Dados do Equipamento -->
        <div class="col-md-6">
            <label for="codigo" class="form-label">Código:</label>
            {{ form.codigo|add_class:"form-control" }}
        </div>

        <div class="col-md-6">
            <label for="numero_serie" class="form-label">Número de Série:</label>
            {{ form.numero_serie|add_class:"form-control" }}
        </div>

        <div class="col-md-6">
            <label for="tipo_instrumento" class="form-label">Tipo de Instrumento:</label>
            {{ form.tipo_instrumento|add_class:"form-select select2" }}
        </div>

        <div class="col-md-6">
            <label for="modelo" class="form-label">Modelo:</label>
            {{ form.modelo|add_class:"form-control" }}
        </div>

        <div class="col-md-6">
            <label for="fabricante" class="form-label">Fabricante:</label>
            {{ form.fabricante|add_class:"form-control" }}
        </div>

        <div class="col-md-6">
            <label for="localizacao" class="form-label">Localização:</label>
            {{ form.localizacao|add_class:"form-control" }}
        </div>

        <div class="col-md-6">
            <label for="responsavel" class="form-label">Responsável:</label>
            {{ form.responsavel|add_class:"form-select select2" }}
        </div>

        <!-- Campos obrigatórios adicionais -->
        <div class="col-md-6">
            <label for="resolucao" class="form-label">Resolução:</label>
            {{ form.resolucao|add_class:"form-control" }}
        </div>

        <div class="col-md-6">
            <label for="proprietario" class="form-label">Proprietário:</label>
            {{ form.proprietario|add_class:"form-control" }}
        </div>

        <!-- Campos opcionais -->
        <div class="col-md-6">
            <label for="frequencia_calibracao" class="form-label">Frequência de Calibração (em meses):</label>
            {{ form.frequencia_calibracao|add_class:"form-control" }}
        </div>

        <div class="col-md-6">
            <label for="capacidade_minima" class="form-label">Capacidade Mínima:</label>
            {{ form.capacidade_minima|add_class:"form-control" }}
        </div>

        <div class="col-md-6">
            <label for="capacidade_maxima" class="form-label">Capacidade Máxima:</label>
            {{ form.capacidade_maxima|add_class:"form-control" }}
        </div>

        <div class="col-md-6">
            <label for="unidade_medida" class="form-label">Unidade de Medida:</label>
            {{ form.unidade_medida|add_class:"form-control" }}
        </div>

        <!-- Botões de ação -->
        <div class="col-12 text-center mt-4">
            <button type="submit" class="btn btn-primary me-2">
                <i class="bi bi-save"></i> Salvar
            </button>
            <a href="{% url 'lista_instrumentos' %}" class="btn btn-secondary ms-2">
                <i class="bi bi-arrow-left"></i> Cancelar
            </a>
        </div>
    </form>
</div>
{% endblock %}

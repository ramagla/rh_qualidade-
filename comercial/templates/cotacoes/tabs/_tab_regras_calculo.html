{% load widget_tweaks %}

<form method="post">
  {% csrf_token %}
  <input type="hidden" name="form_regras_submitted" value="1">

  <div class="row bg-regras p-4 rounded shadow-sm">
    <div class="col-12 col-lg-10 offset-lg-1">
      <div class="border p-4 rounded bg-white shadow-sm">
        <h5 class="mb-4">
          <i class="bi bi-calculator-fill text-info me-2"></i> Regras de Cálculo Tributário
        </h5>

        {% if form_regras.errors %}
          <div class="alert alert-danger">
            <strong>Erros no formulário:</strong>
            <ul class="mt-2 mb-0">
              {% for field in form_regras %}
                {% for error in field.errors %}
                  <li><strong>{{ field.label }}:</strong> {{ error }}</li>
                {% endfor %}
              {% endfor %}
            </ul>
          </div>
        {% endif %}

        <div class="row g-3">
          <div class="col-md-4">
            <label class="form-label">
              <i class="bi bi-percent me-1"></i> ICMS (%)
              <small class="text-muted">padrão: {{ cotacao.icms }}%</small>
            </label>
            {{ form_regras.icms|add_class:"form-control" }}
          </div>
          
          <div class="col-md-4">
            <label class="form-label"><i class="bi bi-percent me-1"></i> PIS (%)</label>
            {{ form_regras.pis|add_class:"form-control" }}
          </div>
          <div class="col-md-4">
            <label class="form-label"><i class="bi bi-percent me-1"></i> Cofins (%)</label>
            {{ form_regras.confins|add_class:"form-control" }}
          </div>
          <div class="col-md-4">
            <label class="form-label"><i class="bi bi-percent me-1"></i> IR (%)</label>
            {{ form_regras.ir|add_class:"form-control" }}
          </div>
          <div class="col-md-4">
            <label class="form-label"><i class="bi bi-percent me-1"></i> CSLL (%)</label>
            {{ form_regras.csll|add_class:"form-control" }}
          </div>
          <div class="col-md-4">
            <label class="form-label"><i class="bi bi-percent me-1"></i> DF (%)</label>
            {{ form_regras.df|add_class:"form-control" }}
          </div>
          <div class="col-md-4">
            <label class="form-label"><i class="bi bi-percent me-1"></i> DV (%)</label>
            {{ form_regras.dv|add_class:"form-control" }}
          </div>
        </div>

        <!-- Botão de envio -->
        <div class="col-12 text-end mt-4">
          <button type="submit" class="btn btn-info">
            <i class="bi bi-save me-1"></i> Salvar Regras
          </button>
        </div>
      </div>
    </div>
  </div>
</form>
